"use strict";!function(){function n(t){var e=this,a=r(t);e.getRoot=function(){return o(a)},e.dfs=function(n){return a=u(a,n)},e.map=function(n){a=i(a,n)},e.normalize=function(){a=f(a)},e.serialize=function(){return l(a)},e.toString=function(){return e.serialize()},e.clone=function(){return new n(a)}}function r(r){if("string"==typeof r)try{r=JSON.parse(r)}catch(t){r=n.parse(r)}return r}function t(n){n=r(n);for(var t in n)if(n.hasOwnProperty(t)&&"name"==t)return n[t]}function e(n){var r="";return n.branchset&&n.branchset.length&&(r+="("+n.branchset.map(e).join(",")+")"),null!=n.name&&(r+=n.name),null!=n.length&&(r+=":"+n.length),r}var a=function(n){for(var r=[],t={},e=n.split(/\s*(;|\(|\)|,|:)\s*/),a=0;a<e.length;a++){var o=e[a];switch(o){case"(":u={};t.branchset=[u],r.push(t),t=u;break;case",":var u={};r[r.length-1].branchset.push(u),t=u;break;case")":t=r.pop();break;case":":break;default:var i=e[a-1];")"==i||"("==i||","==i?t.name=o:":"==i&&(t.length=parseFloat(o))}}return t};n.parse=a;var o=function(n){return t(n)};n.getRoot=o;var u=function(n,t){function e(n){var r=n.branchset||[];if(0!==r.length)for(var o=0;o<r.length;o++)a[r[o].name]=r[o].length,n.branchset[o]=t(n.branchset[o]),e(r[o])}t=t||function(n){return n};var a={};return n=r(n),e(n),a};n.dfs=u;var i=function(t,e){return e=e||function(n){return n},t=r(t),n.dfs(t,null,e),t};n.map=i;var c=function(n){function t(n){var r=n.branchset||[];if(n.hasOwnProperty("length")){for(var e=0,a=0;a<r.length;a++)e+=r[a].length;for(var o=n.length/e,a=0;a<r.length;a++)r[a].length+=r[a].length*o;0!=r.length&&(n.length=0),console.log(n)}for(a=0;a<r.length;a++)t(r[a])}return n=r(n),t(n),n};n.drown=c;var f=function(t){return t=r(t),function(r){var t=n.dfs(r),e=0;for(var a in t)t.hasOwnProperty(a)&&(e+=t[a]);return n.dfs(r,null,function(n){return n.length=n.length/e,n}),r}(t)};n.normalize=f;var l=function(n){return n=r(n),e(n)+";"};n.serialize=l,"undefined"!=typeof window?window.Newick=n:module.exports=n}();